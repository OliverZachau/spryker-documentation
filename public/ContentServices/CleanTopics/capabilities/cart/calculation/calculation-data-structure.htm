<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head />
    <body>The following diagram illustrates the Calculation data structure. https://www.gliffy.com/go/share/image/s10i1vjqws97tfgk4bi0.png?utm_medium=live-embed&amp;utm_source=custom Quote Transfer QuoteTransfer is the main data transfer object used in Cart, Calculation, Checkout and when order is placed. This object is created when first item is added to the cart. The entire data object is stored into the session and it consists of: Field Description totals ( TotalsTransfer ) Order totals. items ( ItemTransfer []) CartItem collection. voucherDiscounts ( DiscountTransfer []) cartRuleDiscounts ( DiscountTransfer []) expenses ( ExpenseTransfer ) priceMode (int) Quote object's price mode. Totals Transfer TotalsTransfer is a data object holding cart totals, subtotal, expenses (shipping), discount total and grand total. Here should the amounts for order level be stored. Field Description subtotal (int) Calculated total amount before taxes and discounts. Is set bySubtotalCalculatorPlugin. expenseTotal (int) Total expenses amount (shipping). It is set byExpenseTotalCalculatorPlugin. discountTotal (int) Total discount amount. It is set byDiscountTotalCalculatorPlugin. taxTotal ( TaxTotalsTransfer ) Tax totals for current cart. Is set byTaxTotalCalculatorPlugin. grandTotal (int) The total amount the customer needs to pay after the discounts are applied. It is set byGrandTotalCalculatorPlugincalculator plugin. refundTotal (int) Total refundable amount. It is set byRefundTotalCalculatorPlugincalculator plugin. canceledTotal (int) Total canceled amount. It is set byCanceledTotalCalculationPlugincalculator plugin. hash (string) Hash from total values to identify amount changes. It is set byGrandTotalCalculatorPlugin. Tax Total Transfer TaxTotalsTransfer holds the taxRate and taxAmount used for the grandTotal. Field Description amount (int) Current tax amount from grandTotal. Item Transfer ItemTransfer is a cart item transfer, holds single product information. Field Description quantity (int) Number of items selected. unitGrossPrice (int) Single item gross price set withCartItemPricePlugin(cart expander). sumGrossPrice (int) Sum of item's gross price, calculated withPriceCalculatorPlugin. unitNetPrice (int) Single item net price, set withCartItemPricePlugin(cart expander). sumNetPrice (int) Sum of items net price, calculated withPriceCalculatorPlugin. unitPrice (int) Single item price without assuming is it new or gross, this value should be used everywhere the price is displayed, it allows switching tax mode without side effects. It's set withCartItemPricePlugin(cart expander). sumPrice (int) Sum of item's price calculated withPriceCalculatorPlugin. taxRate (int) Current tax rate, set byProductItemTaxRateCalculatorPlugin. refundableAmount (int) Item available refundable amount (order only), set byRefundableAmountCalculatorPlugin. unitTaxAmount (int) Tax amount for single item after discounts, set byTaxAmountCalculatorPlugin. sumTaxAmount (int) Tax amount for sum of items (order only), set byTaxAmountCalculatorPlugin. Calculated Discount Transfer [] Item calculated discount collection, set byDiscountCalculatorPlugin. canceledAmount (int) Canceled amount for this item (order only), set by refund , when refund occurs. unitTaxAmountFullAggregation (int) Total tax amount for given item with additions, set byItemTaxAmountFullAggregatorPlugin. sumTaxAmountFullAggregation (int) Total tax amount for given sum of items with additions, set byItemTaxAmountFullAggregatorPlugin. unitProductOptionAggregation (int) Item price with product options, set byItemProductOptionPriceAggregatorPlugin. sumProductOptionAggregation (int) Sum Item price with product options, set byItemProductOptionPriceAggregatorPlugin. unitDiscountAmountAggregation (int) Item total discount amount, set byDiscountAmountAggregatorPlugin. sumDiscountAmountAggregation (int) Sum Item total discount amount, set byDiscountAmountAggregatorPlugin. unitDiscountAmountFullAggregation (int) Item total discount amount with additions, set byItemDiscountAmountFullAggregatorPlugin. sumDiscountAmountFullAggregation (int) Sum Item total discount amount with additions, set byItemDiscountAmountFullAggregatorPlugin. unitPriceToPayAggregation (int) Item total price to pay after discounts with additions, set byPriceToPayAggregatorPlugin. sumPriceToPayAggregation (int) Sum Item total price to pay after discounts with additions, set byPriceToPayAggregatorPlugin. taxRateAverageAggregation (int) Item tax rate average, with additions used when recalculating tax amount after cancellation, set byTaxRateAverageAggregatorPlugin. taxAmountAfterCancellation (int) Tax amount after cancellation, recalculated using tax average, set byTaxAmountAfterCancellationCalculatorPlugin. Calculated Discount Transfer Each item which can have discounts applied has acalculatedDiscountsproperty which holds collection of discounts for each discount type. Field Description displayName (string) Applied discount name. description (string) Applied discount description. voucherCode (string) Used voucher code. quantity(int) Number of discounted items. unitGrossAmount (int) Discount gross amount for single items, set byDiscountCalculatorPlugin. sumGrossAmount (int) Discount gross amount for sum of items, set byDiscountCalculatorPlugin. Product Option Transfer ProductOptionTransfer, some items may have product option collection attached which also have amounts calculated. Field Description idSalesOrderItemOption (int) Sales order item ID option stored after the order is placed. unitGrossPrice (int) single item gross price. It’s setby CartItemProductOptionPlugin(cart expander). sumGrossPrice (int) sum of items gross price. It’s set byPriceCalculatorPlugin(cart expander). unitNetPrice (int) Single item net price. It's set byCartItemProductOptionPlugin(cart expander). sumNetPrice (int) sum of items net price. It's set byPriceCalculatorPlugin(cart expander). unitPrice (int) single item price without assuming is it new or gross, this value should be used everywhere where price is displayed, it allows switching tax mode without side effects. It's set byPriceCalculatorPlugincart expander. taxRate (int) Tax rate in percentage. It’s set byProductOptionTaxRateCalculatorPlugin(cart expander). calculatedDiscounts[] ( CalculatedDiscountTransfer ) Product Option calculated discount collection. It’s set byDiscountCalculatorPlugin. refundableAmount (int) Item available refundable amount (order only), set byRefundableAmountCalculatorPlugin. unitTaxAmount (int) Tax amount for single product option (order only), set byTaxAmountCalculatorPlugin. sumTaxAmount (int) Tax amount for sum of product options (order only), set byTaxAmountCalculatorPlugin. unitDiscountAmountAggregation (int) Product option total discount amount, set byDiscountAmountAggregatorPlugin. sumDiscountAmountAggregation (int) Sum of product option total discount amount, set byDiscountAmountAggregatorPlugin. Discount Transfer DiscountTransfer, is a collection of discounts used in all QuoteTransfer discountable items such as voucherDiscounts and cartRuleDiscounts. Field Description amount (int) total discount amount used for this discount type. It’s set byDiscountCalculatorPlugin ExpenseTransfer Field Description sumGrossPrice (int) Sum of item gross price, set byPriceCalculatorPlugin. unitGrossPrice (string) Single expense price. e.g.: shipment expenses are set in the CheckoutShipmentStep. sumNetPrice (int) Sum of item net price, set byPriceCalculatorPlugin. unitNetPrice (string) Single net price. e.g.: shipment expenses are set in the CheckoutShipmentStep. taxRate (int) Tax in percents, set byShipmentTaxRateCalculatorPlugin. unitPrice (int) Single item price without assuming is it new or gross, this value should be used everywhere where price is displayed, it allows switching tax mode without side effects, set byPriceCalculatorPlugin(cart expander). sumPrice (int) Sum of items price, set byPriceCalculatorPlugin(cart expander). Calculated Discount Transfer List of applied discounts for this item. quantity (int Number of items. refundableAmount (int) Total refundable amount for this item (order only), set byRefundableAmountCalculatorPlugin. canceledAmount (int) Total canceled amount for this item (order only), set by refund . unitTaxAmount (int) Tax amount for single item after discounts, set byTaxAmountCalculatorPlugin. sumTaxAmount (int) Tax amount for sum of items after discounts, set byTaxAmountCalculatorPlugin. unitDiscountAmountAggregation (int) Expense total discount amount, set byDiscountAmountAggregatorPlugin. sumDiscountAmountAggregation (int) Sum of expense total discount amount, set byDiscountAmountAggregatorPlugin.</body>
</html>