<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head />
    <body>The Currency module provides an easy way to retrieve information about a currency given as an ISO code. The methods in theCurrencyFacadewill always return an instance of theCurrencyTransfer. You can get any currency by its ISO code or the current configured currency. Usage CurrencyFacadeexposes the following methods: CurrencyFacade::fromIsoCode() CurrencyFacade::getCurrent() The methods defined in theCurrencyFacadereturn an instance of theCurrencyTransfer, that contains: currency ISO code e.g. EUR currency name e.g. Euro currency symbol e.g. € In addition,CurrencyTransfercontains information that specifies if it is the default currency or not.CurrencyTransfer::$isDefaultcan be used to check if currency that was retrieved byCurrencyFacade::fromIsoCode()is the same as the one configured as default for the current store. From currency version 3, we have introduced currency table where currencies are persisted. And currency facade provides API to read this data. Please check migration guide to migrate to the latest currency module. We have also introduced a currency switcher to Yves. To use it, do the following: Include"\Spryker\Yves\Currency\Plugin\CurrencySwitcherServiceProvider"to your Yves bootstrap and then include twig function"spyCurrencySwitch"in your template where you want the switcher to appear. With this switcher we have introduced a new extension point to act when currency is changed. Implement"\Spryker\Yves\Currency\Dependency\CurrencyPostChangePluginInterface"in your custom plugin, place it to"\Pyz\Yves\Currency\CurrencyDependencyProvider::getCurrencyPostChangePlugins"and get notified when currency is changed. Create a Controller Provider for switcher: &lt;php /**
* This file is part of the Spryker Demoshop.
* For full license information, please view the LICENSE file that was distributed with this source code.
*/ namespace Pyz\Yves\Price\Plugin; use Pyz\Yves\Application\Plugin\Provider\AbstractYvesControllerProvider;
use Silex\Application; class PriceControllerProvider extends AbstractYvesControllerProvider
{ const ROUTE_PRICE_SWITCH = 'price-mode-switch'; /** * @param \Silex\Application $app * * @return void */ protected function defineControllers(Application $app) { $this-&gt;createController( '/price-mode-switch', static::ROUTE_PRICE_SWITCH, 'Price', 'PriceModeSwitch', 'index' ); }
} Register in Yves bootstrap: namespace Pyz\Yves\Application; class YvesBootstrap
{ /** * @param bool|null $isSsl * * @return \Pyz\Yves\Application\Plugin\Provider\AbstractYvesControllerProvider[] */ protected function getControllerProviderStack($isSsl) { return [ ... new CurrencyControllerProvider($isSsl), ... ] }
} Create template in"/Pyz/Yves/Currency/Theme/default/partial/currency_switcher.twig": {% if currencies|length &gt; 1 %} &lt;form method="GET" action="{{ path('currency-switch') }}" data-component="currency-switch"&gt; &lt;select name="currency-iso-code" onchange="this.form.submit()"&gt; {% for currency in currencies %} &lt;option value="{{ currency.code }}" {{ (currency.code == currentCurrency) ? 'selected' : ''}}&gt;{{ currency.name | trans }}&lt;/option&gt; {% endfor %} &lt;/select&gt; &lt;input type="hidden" name="referrer-url" value="{{ app.request.requestUri }}" /&gt; &lt;/form&gt;
{% endif %} In order to get the cart recalculated when currency is switched, you need rebuild quote/recalculate item discounts, prices and other related product data when currency changes.
To do that, install the newcomposer require spryker/cart-currency-connectormodule. Then include plugin\Spryker\Yves\CartCurrencyConnector\CurrencyChange\RebuildCartOnCurrencyChangePluginto currency post change plugin stack: &lt;?php namespace Pyz\Yves\Currency; use Spryker\Yves\CartCurrencyConnector\CurrencyChange\RebuildCartOnCurrencyChangePlugin;
use Spryker\Yves\Currency\CurrencyDependencyProvider as SprykerCurrencyDependencyProvider; class CurrencyDependencyProvider extends SprykerCurrencyDependencyProvider
{ /** * @return \Spryker\Yves\Currency\Dependency\CurrencyPostChangePluginInterface[] */ protected function getCurrencyPostChangePlugins() { return [ new RebuildCartOnCurrencyChangePlugin(), ]; }
} See also: Money Migration Guide - Currency Last review date: Nov 22nd, 2017</body>
</html>