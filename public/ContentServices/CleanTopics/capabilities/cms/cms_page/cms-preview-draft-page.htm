<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head />
    <body>Overview With the CMS draft feature the shop administrator can create drafts of CMS pages without affecting the current live version of the page. It is possible to preview draft version of content before publishing it to see how the page will look like when it is live. This article will tell you how to enable the preview draft page feature. Prerequisites Upgradespryker/cmsmodule to at least 6.2 version. Additional information on how to migrate thespryker/cmsmodule can be found here . If you havespryker/cms-collectormodule installed, upgrade it to at least 2.0 version. Additional information on how to migrate thespryker/cms-collectormodule can be found here . If you do not havespryker/cms-collectormodule installed, register your CMS page data expander plugins tospryker/cmsmodule in theCmsDependencyProviderdependency provider. Example of CMS page data expander plugin registration: &lt;?php
namespace Pyz\Zed\Cms; use Spryker\Zed\Cms\CmsDependencyProvider as SprykerCmsDependencyProvider;
use Spryker\Zed\CmsContentWidget\Communication\Plugin\CmsPageDataExpander\CmsPageParameterMapExpanderPlugin; class CmsDependencyProvider extends SprykerCmsDependencyProvider
{ /** * @return \Spryker\Zed\Cms\Dependency\Plugin\CmsPageDataExpanderPluginInterface[] */ protected function getCmsPageDataExpanderPlugins() { return [ new CmsPageParameterMapExpanderPlugin(), ]; }
} Optionally upgradespryker/cms-guimodule to at least 4.3 version if you want to have access to the Yves preview pages from Administration Interface . Usage in Yves Create a controller action for preview pages in Yves. UseCmsClientInterface::getFlattenedLocaleCmsPageDatato retrieve the flattened draft data for a specific locale. Example of data retrieval: &lt;?php /** * @param int $idCmsPage * * @return array */ protected function getFlattenedLocaleCmsPageData($idCmsPage) { $localeCmsPageDataRequestTransfer = $this-&gt;getClient()-&gt;getFlattenedLocaleCmsPageData( (new FlattenedLocaleCmsPageDataRequestTransfer()) -&gt;setIdCmsPage($idCmsPage) -&gt;setLocale((new LocaleTransfer())-&gt;setLocaleName($this-&gt;getLocale())) ); return $localeCmsPageDataRequestTransfer-&gt;getFlattenedLocaleCmsPageData(); } The retrieved CMS data structure should match the Storage's data structure at this point. You can use your original CMS page rendering twig to display the preview version. Check out our Demoshop for more detailed examples and ideas regarding the complete Yves integration. Configuring Yves Preview Page Access From Administration Interface - Optional Define the Yves preview page URI in configuration with a numeric sprintf placeholder which stands for the CMS page id. Example of preview page URI registration: &lt;?php config_default.php ... $config[CmsGuiConstants::CMS_PAGE_PREVIEW_URI] = '/en/cms/preview/%d'; ... Optionally add "Preview" view button group item to "List of CMS pages" in the Administration Interface by registering theCmsPageTableExpanderPluginplugin to access the preview page. Example of page table expander plugin registration: &lt;?php namespace Pyz\Zed\CmsGui; use Spryker\Zed\CmsGui\CmsGuiDependencyProvider as SprykerCmsGuiDependencyProvider; use Spryker\Zed\CmsGui\Communication\Plugin\CmsPageTableExpanderPlugin; class CmsGuiDependencyProvider extends SprykerCmsGuiDependencyProvider { /** * @return \Spryker\Zed\CmsGui\Dependency\Plugin\CmsPageTableExpanderPluginInterface[] */ protected function getCmsPageTableExpanderPlugins() { return [ new CmsPageTableExpanderPlugin(), ]; } } Optionally add "Preview" action button to "Edit Placeholders" in the Administration Interface by registering theCreateGlossaryExpanderPluginplugin to access the preview page. Example of glossary expander plugin registration: &lt;?php namespace Pyz\Zed\CmsGui; use Spryker\Zed\CmsGui\CmsGuiDependencyProvider as SprykerCmsGuiDependencyProvider; use Spryker\Zed\CmsGui\Communication\Plugin\CreateGlossaryExpanderPlugin; class CmsGuiDependencyProvider extends SprykerCmsGuiDependencyProvider { /** * @return \Spryker\Zed\CmsGui\Dependency\Plugin\CreateGlossaryExpanderPluginInterface[] */ protected function getCreateGlossaryExpanderPlugins() { return [ new CreateGlossaryExpanderPlugin(), ]; } } Restricting Access to Preview Page You can restrict customer access to the preview page by installing and configuringspryker/customer-user-connectormodule. See also: Get a general idea of what a CMS page is Learn how to migrate to a newer version of CMS module Learn how to upgrade to a newer version of CMS collector Last review date: Sep. 22nd, 2017</body>
</html>